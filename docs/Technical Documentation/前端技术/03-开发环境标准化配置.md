# 人力资源调度系统 - 开发环境标准化配置

## 文档概述

### 文档目的
本文档规范人力资源调度系统前端开发环境的标准化配置，确保开发团队环境一致性，提高开发效率和代码质量。

### 适用范围
- 前端开发工程师
- 新员工入职培训
- 开发环境维护
- CI/CD流水线配置

## 基础环境要求

### 操作系统要求
- **Windows**：Windows 10/11 (64位)
- **macOS**：macOS 10.15+ (Catalina及以上)
- **Linux**：Ubuntu 18.04+ / CentOS 7+ / Debian 10+

### 必备软件清单

#### 1. Node.js环境
- **版本要求**：Node.js 18.x LTS (推荐18.17.0+)
- **包管理器**：npm 9.x+ 或 pnpm 8.x+ (推荐pnpm)
- **版本管理**：nvm (Node Version Manager)

**安装步骤**：
```bash
# 安装nvm (Linux/macOS)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Windows用户使用nvm-windows
# 下载地址：https://github.com/coreybutler/nvm-windows

# 安装Node.js
nvm install 18.17.0
nvm use 18.17.0
nvm alias default 18.17.0

# 验证安装
node --version  # 应显示 v18.17.0
npm --version   # 应显示 9.x.x
```

#### 2. 代码编辑器
- **推荐**：Visual Studio Code 1.80+
- **备选**：WebStorm 2023.1+

**VS Code必装插件**：
```json
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "ms-vscode.vscode-json",
    "formulahendry.auto-rename-tag",
    "christian-kohler.path-intellisense",
    "ms-vscode.vscode-css-peek",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-typescript-next"
  ]
}
```

#### 3. 版本控制
- **Git**：2.30+
- **Git GUI**：SourceTree / GitKraken (可选)

**Git配置**：
```bash
# 基础配置
git config --global user.name "Your Name"
git config --global user.email "your.email@company.com"
git config --global init.defaultBranch main
git config --global core.autocrlf input  # Linux/macOS
git config --global core.autocrlf true   # Windows

# 提交模板
git config --global commit.template ~/.gitmessage
```

#### 4. 浏览器环境
- **Chrome**：100+ (主要开发浏览器)
- **Firefox**：100+ (兼容性测试)
- **Safari**：15+ (macOS用户)
- **Edge**：100+ (Windows用户)

**Chrome开发者工具插件**：
- React Developer Tools
- Vue.js devtools
- Redux DevTools
- Lighthouse

### 可选工具
- **终端增强**：Oh My Zsh (macOS/Linux) / PowerShell 7 (Windows)
- **API测试**：Postman / Insomnia
- **设计工具**：Figma / Sketch
- **数据库工具**：DBeaver / pgAdmin

## 项目初始化流程

### 1. 项目克隆
```bash
# 克隆项目仓库
git clone https://github.com/company/hr-scheduling-frontend.git
cd hr-scheduling-frontend

# 切换到开发分支
git checkout develop
```

### 2. 依赖安装
```bash
# 使用pnpm (推荐)
npm install -g pnpm
pnpm install

# 或使用npm
npm install

# 验证安装
pnpm list --depth=0
```

### 3. 环境变量配置

#### 环境变量文件结构
```
├── .env                    # 默认环境变量
├── .env.local             # 本地环境变量 (不提交到Git)
├── .env.development       # 开发环境
├── .env.staging          # 测试环境
└── .env.production       # 生产环境
```

#### .env.development 示例
```bash
# 应用配置
VITE_APP_TITLE=人力资源调度系统
VITE_APP_VERSION=1.0.0
VITE_APP_ENV=development

# API配置
VITE_API_BASE_URL=http://localhost:8000
VITE_API_TIMEOUT=10000
VITE_API_RETRY_COUNT=3

# 认证配置
VITE_AUTH_TOKEN_KEY=hr_access_token
VITE_AUTH_REFRESH_KEY=hr_refresh_token
VITE_AUTH_TOKEN_EXPIRE=3600

# 功能开关
VITE_ENABLE_MOCK=true
VITE_ENABLE_DEBUG=true
VITE_ENABLE_ANALYTICS=false

# 第三方服务
VITE_SENTRY_DSN=
VITE_GOOGLE_ANALYTICS_ID=
```

#### .env.local 示例 (个人配置)
```bash
# 个人开发配置
VITE_DEV_SERVER_PORT=3000
VITE_DEV_SERVER_HOST=0.0.0.0

# 后端服务地址 (可根据个人环境调整)
VITE_API_BASE_URL=http://192.168.1.100:8000

# 调试配置
VITE_DEBUG_LEVEL=debug
VITE_ENABLE_VCONSOLE=true
```

### 4. 项目启动
```bash
# 开发模式启动
pnpm dev

# 指定端口启动
pnpm dev --port 3001

# 指定主机启动 (局域网访问)
pnpm dev --host 0.0.0.0

# 生产构建
pnpm build

# 预览生产构建
pnpm preview
```

### 5. 代码质量检查
```bash
# ESLint检查
pnpm lint

# 自动修复
pnpm lint:fix

# 类型检查
pnpm type-check

# 格式化代码
pnpm format

# 运行测试
pnpm test

# 测试覆盖率
pnpm test:coverage
```

## 开发工具配置

### VS Code配置

#### .vscode/settings.json
```json
{
  "typescript.preferences.importModuleSpecifier": "relative",
  "typescript.suggest.autoImports": true,
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.organizeImports": true
  },
  "emmet.includeLanguages": {
    "typescript": "html",
    "javascript": "html"
  },
  "files.associations": {
    "*.css": "tailwindcss"
  },
  "tailwindCSS.includeLanguages": {
    "typescript": "html",
    "javascript": "html"
  },
  "search.exclude": {
    "**/node_modules": true,
    "**/dist": true,
    "**/.git": true
  }
}
```

#### .vscode/launch.json (调试配置)
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Launch Chrome",
      "type": "chrome",
      "request": "launch",
      "url": "http://localhost:3000",
      "webRoot": "${workspaceFolder}/src",
      "sourceMapPathOverrides": {
        "webpack:///src/*": "${webRoot}/*"
      }
    },
    {
      "name": "Attach to Chrome",
      "type": "chrome",
      "request": "attach",
      "port": 9222,
      "webRoot": "${workspaceFolder}/src"
    }
  ]
}
```

### ESLint配置

#### .eslintrc.js
```javascript
module.exports = {
  root: true,
  env: {
    browser: true,
    es2020: true,
    node: true
  },
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
    'plugin:react/recommended',
    'plugin:react-hooks/recommended',
    'plugin:jsx-a11y/recommended',
    'prettier'
  ],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaFeatures: {
      jsx: true
    },
    ecmaVersion: 2020,
    sourceType: 'module'
  },
  plugins: [
    'react',
    'react-hooks',
    '@typescript-eslint',
    'jsx-a11y',
    'import'
  ],
  rules: {
    'react/react-in-jsx-scope': 'off',
    'react/prop-types': 'off',
    '@typescript-eslint/no-unused-vars': 'error',
    '@typescript-eslint/explicit-function-return-type': 'off',
    'import/order': [
      'error',
      {
        'groups': [
          'builtin',
          'external',
          'internal',
          'parent',
          'sibling',
          'index'
        ],
        'newlines-between': 'always'
      }
    ]
  },
  settings: {
    react: {
      version: 'detect'
    }
  }
};
```

### Prettier配置

#### .prettierrc
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "bracketSpacing": true,
  "bracketSameLine": false,
  "arrowParens": "avoid",
  "endOfLine": "lf"
}
```

## 联调调试指南

### 代理配置

#### Vite代理配置 (vite.config.ts)
```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    host: '0.0.0.0',
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
        secure: false,
        configure: (proxy, options) => {
          proxy.on('error', (err, req, res) => {
            console.log('proxy error', err);
          });
          proxy.on('proxyReq', (proxyReq, req, res) => {
            console.log('Sending Request to the Target:', req.method, req.url);
          });
          proxy.on('proxyRes', (proxyRes, req, res) => {
            console.log('Received Response from the Target:', proxyRes.statusCode, req.url);
          });
        }
      },
      '/ws': {
        target: 'ws://localhost:8000',
        ws: true,
        changeOrigin: true
      }
    }
  },
  build: {
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          antd: ['antd']
        }
      }
    }
  }
});
```

### 跨域解决方案

#### 1. 开发环境代理 (推荐)
```typescript
// 在vite.config.ts中配置代理
proxy: {
  '/api': {
    target: process.env.VITE_API_BASE_URL || 'http://localhost:8000',
    changeOrigin: true,
    rewrite: (path) => path.replace(/^\/api/, '')
  }
}
```

#### 2. 后端CORS配置
```python
# 后端FastAPI CORS配置示例
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000", "http://127.0.0.1:3000"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

#### 3. 浏览器禁用安全策略 (仅开发环境)
```bash
# Chrome启动参数 (仅用于开发测试)
chrome --disable-web-security --disable-features=VizDisplayCompositor --user-data-dir=/tmp/chrome_dev
```

### 调试技巧

#### 1. 网络请求调试
```typescript
// API请求拦截器
import axios from 'axios';

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 10000
});

// 请求拦截器
api.interceptors.request.use(
  (config) => {
    console.log('🚀 Request:', config.method?.toUpperCase(), config.url);
    console.log('📤 Data:', config.data);
    return config;
  },
  (error) => {
    console.error('❌ Request Error:', error);
    return Promise.reject(error);
  }
);

// 响应拦截器
api.interceptors.response.use(
  (response) => {
    console.log('✅ Response:', response.status, response.config.url);
    console.log('📥 Data:', response.data);
    return response;
  },
  (error) => {
    console.error('❌ Response Error:', error.response?.status, error.config?.url);
    console.error('📥 Error Data:', error.response?.data);
    return Promise.reject(error);
  }
);
```

#### 2. 状态调试
```typescript
// Redux DevTools配置
import { configureStore } from '@reduxjs/toolkit';

const store = configureStore({
  reducer: rootReducer,
  devTools: process.env.NODE_ENV !== 'production',
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: ['persist/PERSIST']
      }
    })
});
```

#### 3. 性能调试
```typescript
// React性能分析
import { Profiler } from 'react';

function onRenderCallback(id, phase, actualDuration) {
  console.log('Profiler:', { id, phase, actualDuration });
}

function App() {
  return (
    <Profiler id="App" onRender={onRenderCallback}>
      <Router>
        <Routes>
          {/* 路由配置 */}
        </Routes>
      </Router>
    </Profiler>
  );
}
```

### Mock服务配置

#### 1. MSW (Mock Service Worker) 配置
```typescript
// src/mocks/handlers.ts
import { rest } from 'msw';

export const handlers = [
  rest.get('/api/users', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.json({
        success: true,
        data: {
          items: [
            { id: 1, name: '张三', email: 'zhangsan@example.com' }
          ],
          pagination: { page: 1, size: 20, total: 1, pages: 1 }
        }
      })
    );
  }),
  
  rest.post('/api/auth/login', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.json({
        success: true,
        data: {
          token: 'mock-jwt-token',
          user: { id: 1, username: 'admin', name: '管理员' }
        }
      })
    );
  })
];

// src/mocks/browser.ts
import { setupWorker } from 'msw';
import { handlers } from './handlers';

export const worker = setupWorker(...handlers);

// src/main.tsx
if (import.meta.env.VITE_ENABLE_MOCK === 'true') {
  import('./mocks/browser').then(({ worker }) => {
    worker.start();
  });
}
```

#### 2. JSON Server配置
```bash
# 安装json-server
npm install -g json-server

# 创建mock数据文件 db.json
{
  "users": [
    { "id": 1, "name": "张三", "email": "zhangsan@example.com" }
  ],
  "projects": [
    { "id": 1, "name": "项目A", "status": "active" }
  ]
}

# 启动mock服务
json-server --watch db.json --port 3001
```

## 常见问题解决

### 1. 依赖安装问题
```bash
# 清理缓存
npm cache clean --force
pnpm store prune

# 删除node_modules重新安装
rm -rf node_modules package-lock.json
npm install

# 网络问题使用国内镜像
npm config set registry https://registry.npmmirror.com/
pnpm config set registry https://registry.npmmirror.com/
```

### 2. 端口占用问题
```bash
# 查看端口占用
netstat -ano | findstr :3000  # Windows
lsof -i :3000                 # macOS/Linux

# 杀死进程
taskkill /PID <PID> /F        # Windows
kill -9 <PID>                 # macOS/Linux
```

### 3. 权限问题
```bash
# macOS/Linux权限问题
sudo chown -R $(whoami) ~/.npm
sudo chown -R $(whoami) /usr/local/lib/node_modules

# Windows权限问题
# 以管理员身份运行终端
```

### 4. 热更新不生效
```bash
# 检查文件监听限制 (Linux)
echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
sudo sysctl -p

# 重启开发服务器
pnpm dev --force
```

## 团队协作规范

### Git工作流
```bash
# 功能开发流程
git checkout develop
git pull origin develop
git checkout -b feature/user-management

# 开发完成后
git add .
git commit -m "feat: 添加用户管理功能"
git push origin feature/user-management

# 创建Pull Request
# 代码审查通过后合并到develop分支
```

### 提交信息规范
```bash
# 提交类型
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建工具或辅助工具的变动

# 提交示例
git commit -m "feat(user): 添加用户列表分页功能"
git commit -m "fix(api): 修复登录接口超时问题"
git commit -m "docs(readme): 更新安装说明"
```

### 代码审查清单
- [ ] 代码符合ESLint规则
- [ ] 组件有适当的TypeScript类型定义
- [ ] 新功能有对应的测试用例
- [ ] 性能敏感的代码有优化考虑
- [ ] 无安全漏洞和敏感信息泄露
- [ ] 代码注释清晰，复杂逻辑有说明
- [ ] 遵循项目的命名规范和目录结构

---

*本文档提供开发环境配置规范，请根据项目实际情况进行调整。*